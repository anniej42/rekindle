<!-- bonfireShow 2.0! See bonfireShowOLD for the original. -->


<template name="bonfireShow">
	<div class="title"> <!-- id="stanford85"? -->
	<h1>{{bonfireName}}</h1>
	</div>
	<hr>
	<form>
		<table>
			<tr>
				<td id="members">
	    			{{#if member}}
	    			Members
	    			<button type="button" class="joinleave" id="leavebutton">Leave</button>
	    			{{else}}
	    			Members
	    			{{/if}}
	    		</td>


	    		{{#if member}}

	    		<td id="newpost">
	    			Submit a new post:
	    			<textarea rows="1" class="text toggle" id="newpost-textfield" name="newpost-text" onfocus="this.rows = 3" onblur="if (this.val == '') this.rows = 1"></textarea>
	    			<button type="button" class="button" id="newpost-button">Post</button>
	    			
	    		</td>
	    		{{else}}
	    		<td id="join">
	    			<button type="button" class="joinleave" id="joinleave">Join</button>
	    		</td>
	    		{{/if}}

	    	</tr>
	    	<tr>
	    		<td id="members">

	    			<div id="memberslist">
	    				{{#each members}}
							<a href="{{pathFor 'userShow' _id=this._id}}"><div>
	    					<img src="http://i.imgur.com/tvlf9jv.png">

	    					<div class="groupmember"><b>{{name _id}}</b> <br> {{summary _id}}</div></div></a>
	    				<br>
	    				{{/each}}
	    				<a href="{{pathFor 'bonfireMap' _id=this._id}}"><div class="button" id="maplink">Where are they now?</div></a>
	    			</div>
	    		</td>

	    		<td id="posts">
	    			{{#each messages}}
	    				{{> message}}
					{{/each}}</td>
	    	</tr>
	    </table>
	</form>
</template>


<template name="message">
	<div class="post">
	{{#if is_mine _id}}<a href="{{pathFor 'signup'}}"><div class="icon"></div></a>
		{{else}}<div class="icon"></div>{{/if}}
	<div class="post-text">
		{{#if is_mine _id}}<div class="deleteMessage">x</div>{{/if}}
		<b>{{name user_id}} - {{timestamp _id}}</b>
		<br>
		{{text}}
	</div>
	</div>
	{{#each replies}}
		{{> reply}}
	{{/each}}
	{{#if currentUser}} <!-- if the user is not logged in, they shouldn't be able to reply -->
	<div class="post reply">
		{{#if member bonfire_id}}
		<form>
		<textarea rows="1" class="toggle reply-textfield" id = "reply-textfield-{{_id}}" name="reply-text" placeholder="Reply..." onfocus="this.rows = 3" onblur="if (this.val == '') this.rows = 1"></textarea>
		<input type="hidden" name="parent_id" value="{{_id}}">
		<div class="spacing"><button type="button" class="button reply-button">Reply</button></div></form>

		{{/if}}
	</div>
	{{/if}}
	</template>

	<template name="reply">
		<div class="post reply">
		{{#if is_mine _id}}<a href="{{pathFor 'signup'}}"><div class="icon"></div></a>
		{{else}}<div class="icon"></div>{{/if}}
		<div class="post-text">
			{{#if is_mine _id}}<div class="deleteMessage">x</div>{{/if}}
			<b>{{name user_id}} - {{timestamp _id}}</b>
			<br>
			{{text}}
		</div>
	</div>
	</template>
